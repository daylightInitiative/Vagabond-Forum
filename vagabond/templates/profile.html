{% extends "base.html" %}

{% block content %}

    {% if userinfo %}
        <img style="width: 200px; height: 200px;" class="center-image" src="{{ userinfo.avatar_hash }}">
        <p>Hello, <a href="/users/{{ userinfo.userid }}/">{{ userinfo.username }}</a>! You are user number: {{ userinfo.userid }}<br>Welcome! We appreciate your patronage since {{ userinfo.join_date }}</p>
        {% if is_superuser %}
            <p>As an <b>admin</b>! be sure to use your power to make everyone happy! <b>or else..</b></p>
        {% endif %}
    {% endif %}

    <h2>About Me:</h2>
    <form class="new-post-form" action="/profile" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        <textarea id="description" name="description" maxlength="2000" rows="5" cols="50" required>{{ about_me or '' }}</textarea>
        <br><br>
        <button id="save-description" class="btn btn-primary" type="submit">Save</button>
        <br><br>
    </form>

    {% if sessions %}
        <h2>Login Sessions</h2>
        <button id="sign-out-sessions" class="btn btn-primary" type="button">Sign out all other sessions</button>
        <p style="display:none;" id="status-text"></p>
        {% for sesh in sessions %}
            <b>Status: {{ 'ACTIVE' if sesh.active else 'INACTIVE' }}</b>
            <p>Session from: {{ sesh.userAgent }} by IP address {{ sesh.ipaddr }} on {{ sesh.lastLogin }}</p>
        {% endfor %}

        <script src="{{ url_for('static', filename='js/sign_out_sessions.js') }}"></script>
    {% endif %}
    <link rel="stylesheet" href="/static/css/page_style.css">
{% endblock %}